<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Reacoder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Reacoder">
<meta property="og:url" content="http://reacoder.github.io/">
<meta property="og:site_name" content="Reacoder">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Reacoder">
<meta name="twitter:description">

  
    <link rel="alternative" href="/atom.xml" title="Reacoder" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<div class="profilepic">
			<img src="http://tp2.sinaimg.cn/1918409225/180/40039469631/1">
		</div>

		<hgroup>
		  <h1 class="header-author"><a href="/">Reacoder</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories/Android/">Android</a></li>
				        
							<li><a href="/categories/Java/">Java</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Reacoder" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/1918409225" title="weibo">weibo</a>
					        
								<a class="google" target="_blank" href="https://plus.google.com/u/0/117706805140071058584/posts" title="google">google</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud">
						<a href="/tags/adb/" style="font-size: 10.00px;">adb</a><a href="/tags/animation/" style="font-size: 10.00px;">animation</a><a href="/tags/blog/" style="font-size: 10.00px;">blog</a><a href="/tags/cmd/" style="font-size: 10.00px;">cmd</a><a href="/tags/customView/" style="font-size: 20.00px;">customView</a><a href="/tags/git/" style="font-size: 10.00px;">git</a><a href="/tags/hexo/" style="font-size: 15.00px;">hexo</a><a href="/tags/listview/" style="font-size: 15.00px;">listview</a><a href="/tags/nodejs/" style="font-size: 10.00px;">nodejs</a><a href="/tags/note/" style="font-size: 10.00px;">note</a><a href="/tags/spannableString/" style="font-size: 10.00px;">spannableString</a><a href="/tags/textView/" style="font-size: 10.00px;">textView</a><a href="/tags/touchEvent/" style="font-size: 10.00px;">touchEvent</a><a href="/tags/tutorial/" style="font-size: 10.00px;">tutorial</a><a href="/tags/video/" style="font-size: 10.00px;">video</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					华中科技大学08级，Android程序员，目前在上海联接工作…
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay"></div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="http://tp2.sinaimg.cn/1918409225/180/40039469631/1">
			</div>

			<hgroup>
			  <h1 class="header-author"><a href="/">Reacoder</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories/Android/">Android</a></li>
		        
					<li><a href="/categories/Java/">Java</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Reacoder" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/1918409225" title="weibo">weibo</a>
			        
						<a class="google" target="_blank" href="https://plus.google.com/u/0/117706805140071058584/posts" title="google">google</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      
  
    <article id="post-android-custom-view" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/28/android-custom-view/" class="article-date">
  	<time datetime="2014-11-28T08:35:39.000Z" itemprop="datePublished">Nov 28 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/customView/">customView</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/28/android-custom-view/">android 自定义View</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概览：">概览：</h3>
<ol>
<li>View 的生命周期</li>
<li>Traversals</li>
<li>Measure</li>
<li>Draw</li>
<li>Custom Attributes</li>
<li>监听事件很简单，不讲了</li>
<li>状态保存</li>
<li>参考链接</li>
</ol>
<h3 id="1-_View_的生命周期">1. View 的生命周期</h3>
<ul>
<li>Attachment/detachment（一般不用care）</li>
<li>Traversals（必须care）</li>
<li>State save/restore（看你的需求了）</li>
</ul>
<p>Attachment的回调接口是<code>onAttachedToWindow()</code>，在这里你可以做以下操作</p>
<ul>
<li>Call super.onAttachedToWindow()!</li>
<li>Perform any relevant state resets</li>
<li>Start listening for state changes</li>
</ul>
<p>detachment的回调接口是<code>onDetachedFromWindow()</code>，在这里你可以做以下操作</p>
<ul>
<li>Call super.onDetachedFromWindow()!</li>
<li>Remove any posted Runnables</li>
<li>Stop listening for data changes</li>
<li>Clean up resources <ul>
<li>Bitmaps</li>
<li>Threads</li>
</ul>
</li>
</ul>
<p>看看官方的<code>SwipeRefreshLayout</code>的运用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttachedToWindow</span>() {</div><div class="line">    <span class="keyword">super</span>.onAttachedToWindow();</div><div class="line">    removeCallbacks(mCancel);</div><div class="line">    removeCallbacks(mReturnToStartPosition);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDetachedFromWindow</span>() {</div><div class="line">    <span class="keyword">super</span>.onDetachedFromWindow();</div><div class="line">    removeCallbacks(mReturnToStartPosition);</div><div class="line">    removeCallbacks(mCancel);</div><div class="line">}</div></pre></td></tr></table></figure>

<p>打个简单地比喻就是，如果你的View和网络操作相关的话，最好在这里做取消操作。它这里的操作其实就是取消或重置动画。好了，这里就不多说了，一般用不到。下面说说遍历Traversals。</p>
<h3 id="2-_Traversals">2. Traversals</h3>
<p>Traversals 分四个阶段</p>
<p><strong>Animate—&gt;Measure—&gt;Layout—&gt;Draw</strong></p>
<p>我们现在关心的是Measure和Draw，分别对应<code>onMeasure()</code>,<code>onDraw()</code>,先看看View的默认实现吧。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span>(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec) {</div><div class="line">    setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec),</div><div class="line">            getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec));</div><div class="line">} </div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getDefaultSize</span>(<span class="keyword">int</span> size, <span class="keyword">int</span> measureSpec) {</div><div class="line">    <span class="keyword">int</span> result = size;</div><div class="line">    <span class="keyword">int</span> specMode = MeasureSpec.getMode(measureSpec);</div><div class="line">    <span class="keyword">int</span> specSize = MeasureSpec.getSize(measureSpec);</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> (specMode) {</div><div class="line">    <span class="keyword">case</span> MeasureSpec.UNSPECIFIED:</div><div class="line">        result = size;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> MeasureSpec.AT_MOST:</div><div class="line">    <span class="keyword">case</span> MeasureSpec.EXACTLY:</div><div class="line">        result = specSize;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">}    </div><div class="line">    </div><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span>(Canvas canvas) {</div><div class="line">}</div></pre></td></tr></table></figure>

<p>现在来看看具体的Measure</p>
<h3 id="3-_Measure">3. Measure</h3>
<p>如果你自定义的View没有特殊尺寸要求的话，也可以不重写<code>onMeasure()</code>。现在来说说比较难理解的MeasureSpec 模式，三张图搞定它</p>
<p><img src="http://ww3.sinaimg.cn/mw690/72589a09gw1emqt5tk0q6j20xf0gmq4u.jpg" alt="MeasureSpec.EXACTLY"></p>
<p><img src="http://ww1.sinaimg.cn/mw690/72589a09gw1emqt5ue98bj20xp0gkwg0.jpg" alt="MeasureSpec.AT_MOST"></p>
<p><img src="http://ww4.sinaimg.cn/mw690/72589a09gw1emqt5u7ni2j20z00gp404.jpg" alt="MeasureSpec.UNSPECIFIED"></p>
<p>在<code>onMeasure()</code>里由于没有回调，框架依赖你最后设置尺寸，所以你一定要调用<code>setMeasuredDimension()</code>,否则运行时会crash。</p>
<p>看看大牛Dave Smith 给的一个模板吧：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span>(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec) {</div><div class="line">        <span class="comment">//Get the width measurement</span></div><div class="line">        <span class="keyword">int</span> widthSize = MeasureUtils.getMeasurement(widthMeasureSpec, getDesiredWidth());</div><div class="line"></div><div class="line">        <span class="comment">//Get the height measurement</span></div><div class="line">        <span class="keyword">int</span> heightSize = MeasureUtils.getMeasurement(heightMeasureSpec, getDesiredHeight());</div><div class="line"></div><div class="line">        <span class="comment">//MUST call this to store the measurements</span></div><div class="line">        setMeasuredDimension(widthSize, heightSize);</div><div class="line">    }</div><div class="line">    </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MeasureUtils</span> </span>{</div><div class="line"></div><div class="line">    <span class="javadoc">/**</span></div><div class="line">     * Utility to return a view's standard measurement. Uses the</div><div class="line">     * supplied size when constraints are given. Attempts to</div><div class="line">     * hold to the desired size unless it conflicts with provided</div><div class="line">     * constraints.</div><div class="line">     *</div><div class="line">     *<span class="javadoctag"> @param</span> measureSpec Constraints imposed by the parent</div><div class="line">     *<span class="javadoctag"> @param</span> contentSize Desired size for the view</div><div class="line">     *<span class="javadoctag"> @return</span> The size the view should be.</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getMeasurement</span>(<span class="keyword">int</span> measureSpec, <span class="keyword">int</span> contentSize) {</div><div class="line">        <span class="keyword">int</span> specMode = View.MeasureSpec.getMode(measureSpec);</div><div class="line">        <span class="keyword">int</span> specSize = View.MeasureSpec.getSize(measureSpec);</div><div class="line">        <span class="keyword">int</span> resultSize = <span class="number">0</span>;</div><div class="line">        <span class="keyword">switch</span> (specMode) {</div><div class="line">            <span class="keyword">case</span> View.MeasureSpec.UNSPECIFIED:</div><div class="line">                <span class="comment">//Big as we want to be</span></div><div class="line">                resultSize = contentSize;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> View.MeasureSpec.AT_MOST:</div><div class="line">                <span class="comment">//Big as we want to be, up to the spec</span></div><div class="line">                resultSize = Math.min(contentSize, specSize);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> View.MeasureSpec.EXACTLY:</div><div class="line">                <span class="comment">//Must be the spec size</span></div><div class="line">                resultSize = specSize;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">return</span> resultSize;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="4-_Draw">4. Draw</h3>
<p>这其实没有太多要说的，<code>onDraw()</code>回调已经给你了一个Canvas，你要做的就是画各种你需要的东西了。看看Canvas的官方定义吧：</p>
<blockquote>
<p>The Canvas class holds the “draw” calls. To draw something, you need 4 basic components: A Bitmap to hold the pixels, a Canvas to host the draw calls (writing into the bitmap), a drawing primitive (e.g. Rect, Path, text, Bitmap), and a paint (to describe the colors and styles for the drawing).</p>
</blockquote>
<p>这里的Canvas已经包含一个immutable 的Bitmap了。需要注意的是<code>onDraw()</code>调用的很频繁，实例化对象的操作应该都放到外面。随便看个例子吧：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDraw</span>(Canvas canvas) {</div><div class="line">    <span class="keyword">super</span>.onDraw(canvas);</div><div class="line">    Log.d(tag,<span class="string">"onDraw called"</span>);</div><div class="line">    <span class="keyword">int</span> w = <span class="keyword">this</span>.getWidth();</div><div class="line">    <span class="keyword">int</span> h = <span class="keyword">this</span>.getHeight();</div><div class="line">    <span class="keyword">int</span> t = <span class="keyword">this</span>.getTop();</div><div class="line">    <span class="keyword">int</span> l = <span class="keyword">this</span>.getLeft();</div><div class="line">    <span class="keyword">int</span> ox = w/<span class="number">2</span>;</div><div class="line">    <span class="keyword">int</span> oy = h/<span class="number">2</span>;</div><div class="line">    <span class="keyword">int</span> rad = Math.min(ox,oy)/<span class="number">2</span>;</div><div class="line">    canvas.drawCircle(ox, oy, rad, getBrush());</div><div class="line">}</div></pre></td></tr></table></figure>

<p>其实这里的获取宽高的操作应该放到<code>onSizeChanged()</code>里面，这个是在<code>onLayout()</code>里调用的，而且一般只遍历一次。</p>
<h3 id="5-_Custom_Attributes">5. Custom Attributes</h3>
<p>这个没什么要讲的，看例子就理解了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Listing 1-18. Defining Custom Attributes in attrs.xml</div><div class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">declare-styleable</span> <span class="attribute">name</span>=<span class="value">"CircleView"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"strokeWidth"</span> <span class="attribute">format</span>=<span class="value">"integer"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"strokeColor"</span> <span class="attribute">format</span>=<span class="value">"color|reference"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">declare-styleable</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></div></pre></td></tr></table></figure>

<p>下面这段好好理解<br>Given the attrs.xml in Listing 1-18, Android generates the following IDs:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">R.attr.strokeWidth (<span class="keyword">int</span>)</div><div class="line">R.attr.srokeColor (<span class="keyword">int</span>)</div><div class="line">R.styleable.CircelView (an array of ints)</div><div class="line">R.styleable.CircleView_strokeWidth (offset into the array)</div><div class="line">R.styleable.CircelView_strokeColor (offset into the array)</div></pre></td></tr></table></figure>

<p>在初始化时</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="title">CircleView</span>(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle) {</div><div class="line">    <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">    <span class="comment">//Use the array constant to read the bag once</span></div><div class="line">    TypedArray t = context.obtainStyledAttributes(attrs,</div><div class="line">                     R.styleable.CircleView,</div><div class="line">                     defStyle, <span class="comment">//if any values are in the theme</span></div><div class="line">                     <span class="number">0</span>); <span class="comment">//Do you have your own style group</span></div><div class="line">    <span class="comment">//Use the offset in the bag to get your value</span></div><div class="line">    strokeColor = t.getColor(R.styleable.CircleView_strokeColor, mDefaultStrokeColor);</div><div class="line">    strokeWidth = t.getInt(R.styleable.CircleView_strokeWidth, mDefaultStrokeWidth);</div><div class="line">    <span class="comment">//Recycle the typed array</span></div><div class="line">    t.recycle();</div><div class="line">    <span class="comment">//Go ahead and initialize your class.</span></div><div class="line">    initCircleView();</div><div class="line">}</div></pre></td></tr></table></figure>

<blockquote>
<p>DON’T FORGET: TypedArrays are heavyweight objects that should be recycled immediately after all the attributes you need have been extracted.</p>
</blockquote>
<h3 id="6-_监听事件很简单，不讲了">6. 监听事件很简单，不讲了</h3>
<h3 id="7-_状态保存">7. 状态保存</h3>
<p>用系统的方式保存状态，万无一失，下面看模板:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * ***************************************************************</div><div class="line"> * Save and restore work</div><div class="line"> * ***************************************************************</div><div class="line"> */</div><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceState</span>(Parcelable p) {</div><div class="line">    <span class="keyword">this</span>.onRestoreInstanceStateStandard(p);</div><div class="line">    <span class="keyword">this</span>.initCircleView();</div><div class="line">}</div><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">protected</span> Parcelable <span class="title">onSaveInstanceState</span>() {</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.onSaveInstanceStateStandard();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">onRestoreInstanceStateStandard</span>(Parcelable state) {</div><div class="line">    <span class="comment">//If it is not yours doesn't mean it is BaseSavedState</span></div><div class="line">    <span class="comment">//You may have a parent in your hierarchy that has their own</span></div><div class="line">    <span class="comment">//state derived from BaseSavedState</span></div><div class="line">    <span class="comment">//It is like peeling an onion or a Russian doll</span></div><div class="line">    <span class="keyword">if</span> (!(state <span class="keyword">instanceof</span> SavedState)) {</div><div class="line">        <span class="keyword">super</span>.onRestoreInstanceState(state);</div><div class="line"><span class="keyword">return</span>; }</div><div class="line">    <span class="comment">//it is our state</span></div><div class="line">    SavedState ss = (SavedState)state;</div><div class="line">    <span class="comment">//Peel it and give the child to the super class</span></div><div class="line">    <span class="keyword">super</span>.onRestoreInstanceState(ss.getSuperState());</div><div class="line">    defRadius = ss.defRadius;</div><div class="line">}</div><div class="line"><span class="keyword">private</span> Parcelable <span class="title">onSaveInstanceStateStandard</span>() {</div><div class="line">    Parcelable superState = <span class="keyword">super</span>.onSaveInstanceState();</div><div class="line">    SavedState ss = <span class="keyword">new</span> SavedState(superState);</div><div class="line">    ss.defRadius = <span class="keyword">this</span>.defRadius;</div><div class="line"><span class="keyword">return</span> ss; }</div><div class="line"><span class="comment">/*</span></div><div class="line">* *************************************************************** * Saved State inner static class</div><div class="line">* *************************************************************** */</div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SavedState</span> <span class="keyword">extends</span> <span class="title">BaseSavedState</span> </span>{</div><div class="line">    <span class="keyword">int</span> defRadius;</div><div class="line">    SavedState(Parcelable superState) {</div><div class="line">        <span class="keyword">super</span>(superState);</div><div class="line">}</div><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span>(Parcel out, <span class="keyword">int</span> flags) {</div><div class="line">        <span class="keyword">super</span>.writeToParcel(out, flags);</div><div class="line">        out.writeInt(defRadius);</div><div class="line">    }</div><div class="line">    <span class="comment">//Read back the values</span></div><div class="line">    <span class="keyword">private</span> <span class="title">SavedState</span>(Parcel in) {</div><div class="line"><span class="keyword">super</span>(in);</div><div class="line">        defRadius = in.readInt();</div><div class="line">    }</div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> String <span class="title">toString</span>() {</div><div class="line">        <span class="keyword">return</span> <span class="string">"CircleView defRadius:"</span> + defRadius;</div><div class="line">    }</div><div class="line">    <span class="annotation">@SuppressWarnings</span>(<span class="string">"hiding"</span>)</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Parcelable.Creator&lt;SavedState&gt; CREATOR</div><div class="line">            = <span class="keyword">new</span> Parcelable.Creator&lt;SavedState&gt;() {</div><div class="line">        <span class="keyword">public</span> SavedState <span class="title">createFromParcel</span>(Parcel in) {</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> SavedState(in);</div><div class="line">        }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> SavedState[] <span class="title">newArray</span>(<span class="keyword">int</span> size) {</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SavedState[size];</div><div class="line">    } </div><div class="line">    };</div><div class="line">    }<span class="comment">//eof-state-class</span></div><div class="line">}<span class="comment">//eof-main-view class</span></div></pre></td></tr></table></figure>

<h3 id="8-_参考链接">8. 参考链接</h3>
<p><a href="https://www.youtube.com/watch?v=NYtB6mlu7vA" target="_blank" rel="external">https://www.youtube.com/watch?v=NYtB6mlu7vA</a><br><a href="https://thenewcircle.com/s/post/1663/tutorial_enhancing_android_ui_with_custom_views_dave_smith_video" target="_blank" rel="external">https://thenewcircle.com/s/post/1663/tutorial_enhancing_android_ui_with_custom_views_dave_smith_video</a><br><a href="https://dl.dropboxusercontent.com/u/16714463/Google%20IO%202014/Material%20Witness.pdf" target="_blank" rel="external">https://dl.dropboxusercontent.com/u/16714463/Google%20IO%202014/Material%20Witness.pdf</a><br><a href="http://developer.android.com/training/custom-views/index.html" target="_blank" rel="external">http://developer.android.com/training/custom-views/index.html</a><br><a href="http://developer.android.com/guide/topics/ui/custom-components.html" target="_blank" rel="external">http://developer.android.com/guide/topics/ui/custom-components.html</a></p>
<p>《Expert Android》</p>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
    <article id="post-android-tutorial" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/26/android-tutorial/" class="article-date">
  	<time datetime="2014-11-26T07:21:37.000Z" itemprop="datePublished">Nov 26 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tutorial/">tutorial</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/26/android-tutorial/">android 学习资源</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://developer.android.com/assets/images/dac_logo@2x.png" alt="developer"></p>
<p><a href="http://developer.android.com/training/basics/firstapp/index.html" target="_blank" rel="external">http://developer.android.com/training/basics/firstapp/index.html</a></p>
<hr>
<p><img src="http://i.imgur.com/XgxWfyF.png" alt="codepath"></p>
<p><a href="http://guides.codepath.com/android" target="_blank" rel="external">http://guides.codepath.com/android</a></p>
<hr>
<p><img src="http://www.vogella.com/img/logo/xindex_logo.png.pagespeed.ic.S0rT7Uq_V2.png" alt="vogella"></p>
<p><a href="http://www.vogella.com/tutorials/android.html" target="_blank" rel="external">http://www.vogella.com/tutorials/android.html</a></p>
<hr>
<p><strong>Android Programming Tutorials</strong></p>
<p><a href="http://www.edumobile.org/android/" target="_blank" rel="external">http://www.edumobile.org/android/</a></p>
<hr>
<p><img src="http://www.technotalkative.com/wp-content/uploads/2013/11/tt_logo.png" alt=""></p>
<p><a href="http://www.technotalkative.com/category/android/" target="_blank" rel="external">http://www.technotalkative.com/category/android/</a></p>
<hr>
<p><img src="http://sampleprogramz.com/images/android/android.png" alt=""></p>
<p><a href="http://sampleprogramz.com/android/slidingdrawer.php" target="_blank" rel="external">http://sampleprogramz.com/android/slidingdrawer.php</a></p>
<hr>
<p><img src="http://ogrelab.ikratko.com/wp-content/themes/ogrelab/images/logo.png" alt=""></p>
<p><a href="http://ogrelab.ikratko.com/category/java/android/" target="_blank" rel="external">http://ogrelab.ikratko.com/category/java/android/</a></p>
<hr>
<p><img src="http://www.jayway.com/wp-content/uploads/2014/05/Jayway_logotype_180_invert.png" alt=""></p>
<p><a href="http://www.jayway.com/tag/android/" target="_blank" rel="external">http://www.jayway.com/tag/android/</a></p>
<hr>
<p><img src="http://square.github.io/images/logo.png" alt=""></p>
<p><a href="http://square.github.io/" target="_blank" rel="external">http://square.github.io/</a></p>
<hr>
<p><img src="http://vinsol.com/blog/wp-content/themes/Vinsol2.0BlogTheme/images/vin_logo.png" alt=""></p>
<p><a href="http://vinsol.com/blog/" target="_blank" rel="external">http://vinsol.com/blog/</a></p>
<hr>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
    <article id="post-blog-you-need-to-reed" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/26/blog-you-need-to-reed/" class="article-date">
  	<time datetime="2014-11-26T06:45:47.000Z" itemprop="datePublished">Nov 26 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blog/">blog</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/26/blog-you-need-to-reed/">国外大牛们的博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://androidweekly.net/assets/newsletter/logo_new-d0c4136e89ff4c744dce6560c27a7050.png" align="middle" width="50" height="50">    </p>
<p><strong>Android Weekly</strong></p>
<ul>
<li><a href="http://androidweekly.net/" target="_blank" rel="external">BlogSite</a></li>
</ul>
<hr>
<p><img src="http://3.bp.blogspot.com/-l7gnNEh4qg8/UKqmMerltLI/AAAAAAAAC-c/_aid9jTg9Zk/s1600/blogheader2.png" align="middle" width="50" height="50">     </p>
<p><strong>Android Developers Blog</strong></p>
<ul>
<li><p><a href="http://android-developers.blogspot.jp/" target="_blank" rel="external">BlogSite</a></p>
<hr>
</li>
</ul>
<p><img src="https://avatars1.githubusercontent.com/u/215725?v=3&s=400" align="middle" width="5" height="50"></p>
<p><strong>Dave Smith</strong></p>
<ul>
<li><p><a href="http://wiresareobsolete.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/devunwired" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://avatars0.githubusercontent.com/u/869684?v=3&s=460" align="middle" width="50" height="50">    </p>
<p><strong>Romain Guy</strong></p>
<ul>
<li><p><a href="http://www.curious-creature.org/category/android/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/romainguy" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="http://chiuki.github.io/images/chiuki.jpg" align="middle" width="50" height="50">    </p>
<p><strong>Chiu-Ki Chan</strong></p>
<ul>
<li><p><a href="http://chiuki.github.io/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/chiuki" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://avatars2.githubusercontent.com/u/514850?v=3&s=400" align="middle" width="50" height="50">    </p>
<p><strong>Daniel Lew</strong></p>
<ul>
<li><p><a href="http://blog.danlew.net/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/dlew" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="http://androidweekly.net/assets/landingpage/testimonials/allison-8286c45d212168fec809d5be0f26c3a7.jpg" align="middle" width="50" height="50">    </p>
<p><strong>Mark Allison</strong></p>
<ul>
<li><p><a href="http://blog.stylingandroid.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/StylingAndroid" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://avatars1.githubusercontent.com/u/2179751?v=3&s=460" align="middle" width="50" height="50">    </p>
<p><strong>Wolfram Rittmeyer</strong></p>
<ul>
<li><p><a href="http://www.grokkingandroid.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/writtmeyer" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="http://ecx.images-amazon.com/images/I/61dHJJsXxFL._UX250_.jpg" align="middle" width="50" height="50">    </p>
<p><strong>Mark Murphy</strong></p>
<ul>
<li><p><a href="http://commonsware.com/blog/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/commonsguy" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://avatars2.githubusercontent.com/u/92794?v=3&s=460" align="middle" width="50" height="50">    </p>
<p><strong>Cyril Mottier</strong></p>
<ul>
<li><p><a href="http://cyrilmottier.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/cyrilmottier" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="http://martin.cubeactive.com/wp-content/uploads/2010/06/2d1a206b-46e0-4407-9579-3fdbbd6337e8-150x150.jpg" align="middle" width="50" height="50">    </p>
<p><strong>Martin van Zuilekom</strong></p>
<ul>
<li><p><a href="http://martin.cubeactive.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/MartinvanZ" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://chris.banes.me/content/images/me.jpg" align="middle" width="50" height="50">    </p>
<p><strong>Chris Banes</strong></p>
<ul>
<li><p><a href="https://chris.banes.me/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/chrisbanes" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><img src="https://avatars0.githubusercontent.com/u/2178243?v=3&s=400" align="middle" width="50" height="50">    </p>
<p><strong>Antonio Leiva</strong></p>
<ul>
<li><p><a href="http://antonioleiva.com/" target="_blank" rel="external">BlogSite</a></p>
</li>
<li><p><a href="https://github.com/antoniolg" target="_blank" rel="external">GitHub</a></p>
</li>
</ul>
<hr>
<p><strong>More</strong></p>
<p><a href="https://github.com/android-cn/android-dev-com" target="_blank" rel="external">https://github.com/android-cn/android-dev-com</a></p>
<p><a href="https://github.com/android-cn/android-dev-cn" target="_blank" rel="external">https://github.com/android-cn/android-dev-cn</a></p>
<p><a href="https://github.com/futurice/android-best-practices" target="_blank" rel="external">https://github.com/futurice/android-best-practices</a></p>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
    <article id="post-android-develop-note" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/25/android-develop-note/" class="article-date">
  	<time datetime="2014-11-25T04:55:06.000Z" itemprop="datePublished">Nov 25 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/note/">note</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/25/android-develop-note/">android 开发全纪录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="">ActionBar</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/custom-ActionMode" target="_blank" rel="external">custom ActionMode</a></li>
</ul>
<p><a href="">Activity</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/drawerLayout-framework" target="_blank" rel="external">drawerLayout framework</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/view-page-indicator-framework" target="_blank" rel="external">view page indicator framework</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/blob/master/PRE_andevcon_mastering-the-android-touch-system.pdf" target="_blank" rel="external">mastering the android touch system</a></li>
</ul>
<p><a href="">Animation</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/listview-animation" target="_blank" rel="external">listview animation</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/activity-animation" target="_blank" rel="external">activity animation</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/listview-item-show-animation" target="_blank" rel="external">listview item show animation</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/listview-item-show-animation-better" target="_blank" rel="external">listview item show animation better</a></li>
</ul>
<p><a href="">APK</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/Get-apk-file-icon,-version,-name" target="_blank" rel="external">Get apk file icon, version, name</a></li>
<li><a href="http://stackoverflow.com/questions/6813322/install-uninstall-apks-programmatically-packagemanager-vs-intents" target="_blank" rel="external">install / uninstall APKs programmatically (PackageManager vs Intents)</a></li>
</ul>
<p><a href="">App</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/app-can-move-to-SDCard-or-not" target="_blank" rel="external">app can move to SDCard or not</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/get-memory-usage-of-apps" target="_blank" rel="external">get memory usage of apps</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/get-user-installed-apps-and-apps&#39;-size" target="_blank" rel="external">get user installed apps and apps’ size</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/get-running-apps-and-their-memory" target="_blank" rel="external">get running apps and their memory</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/free-all-apps&#39;-cache" target="_blank" rel="external">free all apps’ cache</a></li>
</ul>
<p><a href="">DB</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/get-picture-of-music" target="_blank" rel="external">get picture of music</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/greenDao-generator-java-project" target="_blank" rel="external">greenDao generator java project</a></li>
</ul>
<p><a href="">Gradle</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/build.gradle-and-proguard" target="_blank" rel="external">build.gradle and proguard</a></li>
</ul>
<p><a href="">Hardware</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/AirplaneUtil" target="_blank" rel="external">AirplaneUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/BluetoothUtil" target="_blank" rel="external">BluetoothUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/FlashLightUtil" target="_blank" rel="external">FlashLightUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/GPRSUtil" target="_blank" rel="external">GPRSUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/GPSUtil" target="_blank" rel="external">GPSUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/MuteModeUtil" target="_blank" rel="external">MuteModeUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/RotateUtil" target="_blank" rel="external">RotateUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/ScreenBrightUtil" target="_blank" rel="external">ScreenBrightUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/ScreenOffUtil" target="_blank" rel="external">ScreenOffUtil</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/WifiUtil" target="_blank" rel="external">WifiUtil</a></li>
</ul>
<p><a href="">Intent</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/Android-%E5%B8%B8%E7%94%A8-mimeType-%E8%A1%A8" target="_blank" rel="external">Android 常用 mimeType 表</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/open-default-calculator" target="_blank" rel="external">open default calculator</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/get-alarm,calculator,gallery,camera,battery,share-intent" target="_blank" rel="external">get alarm,calculator,gallery,camera,battery,share intent</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/open-uninstall-setting-page" target="_blank" rel="external">open uninstall setting page</a></li>
</ul>
<p><a href="">ListView</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/cancel-listView-scroll" target="_blank" rel="external">cancel listView scroll</a></li>
</ul>
<p><a href="">Shortcut</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/make-launcher-shortcut-for-boost." target="_blank" rel="external">make launcher shortcut for boost.</a></li>
</ul>
<p><a href="">TextView</a></p>
<ul>
<li><a href="http://orgcent.com/android-textview-spannablestring-span/" target="_blank" rel="external">TextView使用SpannableString设置复合文本</a></li>
<li><a href="http://blog.csdn.net/lixin84915/article/details/8110667" target="_blank" rel="external"> Android文本样式</a></li>
</ul>
<p><a href="">Util</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/string-util-include-date" target="_blank" rel="external">string util include date</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/SystemUtil-with-ram,temperature,storage,music,pictures" target="_blank" rel="external">SystemUtil with ram,temperature,storage,music,pictures</a></li>
</ul>
<p><a href="">View</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/CheckableTextView" target="_blank" rel="external">CheckableTextView</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/CheckBox-with-different-bg" target="_blank" rel="external">CheckBox with different bg</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/Dashboard" target="_blank" rel="external">Dashboard</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/RightUpperCornerText" target="_blank" rel="external">RightUpperCornerText</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/SearchView" target="_blank" rel="external">SearchView</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/custom-progress-bar" target="_blank" rel="external">custom progress bar</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/custom-video-controller" target="_blank" rel="external">custom video controller</a></li>
<li><a href="https://github.com/Reacoder/AndroidDevelopNote/wiki/custom-progress-circle" target="_blank" rel="external">custom progress circle</a></li>
</ul>
<p><a href="">Window</a></p>
<ul>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/open-popup-window" target="_blank" rel="external">open popup window</a></li>
<li><a href="https://github.com/sampythoner/AndroidDevelopNote/wiki/add-global-player-window-which-can-move-in-Y" target="_blank" rel="external">add global player window which can move in Y</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
    <article id="post-right-upper-corner-textview" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/24/right-upper-corner-textview/" class="article-date">
  	<time datetime="2014-11-24T14:14:40.000Z" itemprop="datePublished">Nov 24 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/customView/">customView</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spannableString/">spannableString</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/textView/">textView</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/24/right-upper-corner-textview/">textview带有右上角文字</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://img.my.csdn.net/uploads/201411/25/1416884514_7020.png" alt="rightuptext pic"></p>
<h3 id="1-RightUpperCornerText_代码">1.<code>RightUpperCornerText</code> 代码</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RightUpperCornerText</span> <span class="keyword">extends</span> <span class="title">TextView</span> </span>{</div><div class="line">    <span class="keyword">private</span> Paint mPaint;</div><div class="line">    <span class="keyword">private</span> String mCornerText;</div><div class="line">    <span class="keyword">private</span> Context mContext;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">RightUpperCornerText</span>(Context context) {</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">        init(context);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">RightUpperCornerText</span>(Context context, AttributeSet attrs) {</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">        init(context);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="title">RightUpperCornerText</span>(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyle) {</div><div class="line">        <span class="keyword">super</span>(context, attrs, defStyle);</div><div class="line">        init(context);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span>(Context context) {</div><div class="line">        mContext = context;</div><div class="line">        mPaint = <span class="keyword">new</span> Paint();</div><div class="line">        mPaint.setAntiAlias(<span class="keyword">true</span>);</div><div class="line">        mPaint.setColor(Color.WHITE);</div><div class="line"></div><div class="line">        <span class="keyword">float</span> cornerSize = getTextSize() * <span class="number">0.6</span>f;</div><div class="line">        <span class="keyword">if</span> (cornerSize &gt; <span class="number">50</span>) {</div><div class="line">            cornerSize = <span class="number">50</span>;</div><div class="line">        }</div><div class="line">        mPaint.setTextSize(cornerSize);</div><div class="line">        mCornerText = <span class="string">""</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span>(Canvas canvas) {</div><div class="line">        <span class="keyword">super</span>.onDraw(canvas);</div><div class="line"></div><div class="line">        <span class="comment">// 不要忘了设置 Padding</span></div><div class="line">        String text = (String) getText();</div><div class="line">        Rect bounds = <span class="keyword">new</span> Rect();</div><div class="line">        getPaint().getTextBounds(text, <span class="number">0</span>, text.length(), bounds);</div><div class="line">        canvas.drawText(mCornerText, getPaddingLeft() + bounds.right + bounds.left,</div><div class="line">                (canvas.getHeight() + bounds.top) / <span class="number">2</span> + mPaint.measureText(mCornerText),</div><div class="line">                mPaint);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCornertext</span>(String text) {</div><div class="line">        mCornerText = text;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCornertextSize</span>(<span class="keyword">float</span> size) {</div><div class="line">        mPaint.setTextSize(TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,</div><div class="line">                size, mContext.getResources().getDisplayMetrics()));</div><div class="line">        invalidate();</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="2-_用法">2. 用法</h3>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">com.ilegendsoft.toprankapps.cleanmaster.UI.RightUpperCornerText</span></span></div><div class="line">    <span class="attribute">android:id</span>=<span class="value">"@+id/dashboard_percentage"</span></div><div class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></div><div class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></div><div class="line">    <span class="attribute">android:padding</span>=<span class="value">"20dp"</span></div><div class="line">    <span class="attribute">android:layout_centerInParent</span>=<span class="value">"true"</span></div><div class="line">    <span class="attribute">android:textColor</span>=<span class="value">"@android:color/white"</span></div><div class="line">    <span class="attribute">android:textSize</span>=<span class="value">"26sp"</span> /&gt;</div></pre></td></tr></table></figure>

<p><code>mPercentageView.setCornertext(cornerText);</code></p>
<p><strong>注意</strong> <code>android:padding=&quot;20dp&quot;</code>设置padding 很重要，否则没地方画了。</p>
<h3 id="3-_其实完全没必要自定义，采用TextView_Style可以实现各种样式的字体排版，就是SpannableString">3. 其实完全没必要自定义，采用<code>TextView Style</code>可以实现各种样式的字体排版，就是<code>SpannableString</code></h3>
<p>先看下图片</p>
<p><img src="http://orgcent.com/wp-content/uploads/2012/04/textview_spannablestring.jpg" alt="复合文本图片"></p>
<p>具体参考如下链接：</p>
<ul>
<li><a href="http://orgcent.com/android-textview-spannablestring-span/" target="_blank" rel="external">TextView使用SpannableString设置复合文本</a></li>
<li><a href="http://blog.csdn.net/lixin84915/article/details/8110667" target="_blank" rel="external">Android文本样式</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
    <article id="post-listview-animation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/24/listview-animation/" class="article-date">
  	<time datetime="2014-11-24T14:08:59.000Z" itemprop="datePublished">Nov 24 2014</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/animation/">animation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/listview/">listview</a></li></ul>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/24/listview-animation/">listview item进入和删除动画</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-先看一下最终效果">1.先看一下最终效果</h3>
<p><img src="https://raw.githubusercontent.com/Reacoder/AndroidDevelopNote/master/listview_animation.gif" alt="listview"></p>
<h3 id="2-从右边划入的动画">2.从右边划入的动画</h3>
<ul>
<li>定义xml动画</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">translate</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attribute">android:duration</span>=<span class="value">"@integer/animTime"</span></div><div class="line">    <span class="attribute">android:fromXDelta</span>=<span class="value">"100%p"</span></div><div class="line">    <span class="attribute">android:toXDelta</span>=<span class="value">"0%p"</span> &gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="title">translate</span>&gt;</span></div></pre></td></tr></table></figure>

<ul>
<li><code>Adapter</code>里只需要写如下代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> View <span class="title">getChildView</span>(<span class="keyword">final</span> <span class="keyword">int</span> groupPosition, <span class="keyword">int</span> childPosition, </div><div class="line">     <span class="keyword">boolean</span> isLastChild, View convertView, ViewGroup parent) {</div><div class="line">    ....</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!junk.isAnimatedBefore()) {</div><div class="line">        junk.setAnimatedBefore(<span class="keyword">true</span>);</div><div class="line">        convertView.startAnimation(AnimationUtils.loadAnimation(mContext, R.anim.slide_left_in));</div><div class="line">    }<span class="keyword">else</span>{</div><div class="line">        convertView.clearAnimation();</div><div class="line">    }</div><div class="line">    <span class="keyword">return</span> convertView;</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="3-从左边划出的动画">3.从左边划出的动画</h3>
<ul>
<li>定义xml动画</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">set</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attribute">android:fillEnabled</span>=<span class="value">"true"</span></div><div class="line">    <span class="attribute">android:fillAfter</span>=<span class="value">"true"</span></div><div class="line">    <span class="attribute">android:duration</span>=<span class="value">"@integer/animTime"</span>&gt;</div><div class="line">    <span class="tag">&lt;<span class="title">translate</span></span></div><div class="line">        <span class="attribute">android:fromXDelta</span>=<span class="value">"0%p"</span></div><div class="line">        <span class="attribute">android:toXDelta</span>=<span class="value">"-100%p"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="title">translate</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">set</span>&gt;</span></div></pre></td></tr></table></figure>

<ul>
<li><code>Adapter</code>里不需要做什么，需要在外面操作<code>ListView</code>.</li>
</ul>
<h3 id="4-在外面操作ListView">4.在外面操作<code>ListView</code></h3>
<ul>
<li>开始动画</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startBoost</span>() {</div><div class="line">    mIsDeleting = <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">boolean</span> hasAnimation = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">long</span> offset = <span class="number">0</span>;</div><div class="line">    mAnimCount = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> groupPosition = -<span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> childPosition = -<span class="number">1</span>;</div><div class="line">    Iterator&lt;ArrayList&lt;Junk&gt;&gt; listIterator = mChildren.iterator();</div><div class="line">    <span class="keyword">while</span> (listIterator.hasNext()) {</div><div class="line">        groupPosition++;</div><div class="line">        <span class="keyword">final</span> Iterator&lt;Junk&gt; junkIterator = listIterator.next().iterator();</div><div class="line">        <span class="keyword">while</span> (junkIterator.hasNext()) {</div><div class="line">            childPosition++;</div><div class="line">            Junk junk = junkIterator.next();</div><div class="line">            <span class="keyword">if</span> (junk.isChecked()) {</div><div class="line">                ...</div><div class="line">                junkIterator.remove();</div><div class="line">                <span class="keyword">final</span> View itemView = ListViewUtil.getChildItemView(<span class="keyword">this</span>,</div><div class="line">                                                 mListView, groupPosition, childPosition);</div><div class="line">                <span class="keyword">if</span> (itemView != <span class="keyword">null</span>) {</div><div class="line">                    hasAnimation = <span class="keyword">true</span>;</div><div class="line">                    ((Animation) itemView.getTag(R.id.anim)).setAnimationListener(mAnimationListener);</div><div class="line">                    ((Animation) itemView.getTag(R.id.anim)).setStartOffset(offset);</div><div class="line">                    offset += <span class="number">100</span>;</div><div class="line">                    itemView.startAnimation(((Animation) itemView.getTag(R.id.anim)));</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keyword">if</span> (!hasAnimation) {</div><div class="line">        deleteCompleted();</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<ul>
<li><code>mAnimationListener</code>定义如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> Animation.AnimationListener mAnimationListener = <span class="keyword">new</span> Animation.AnimationListener() {</div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span>(Animation animation) {</div><div class="line">        mAnimCount++;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span>(Animation animation) {</div><div class="line">        mAnimCount--;</div><div class="line">        <span class="keyword">if</span> (mAnimCount == <span class="number">0</span>) {</div><div class="line">            deleteCompleted();</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span>(Animation animation) {</div><div class="line"></div><div class="line">    }</div><div class="line">};</div></pre></td></tr></table></figure>

<ul>
<li>删除完成后需要调用<code>ListViewUtil.clearListViewAnim(this, mListView);</code>,否则原来动画的地方会显示空白。</li>
<li>动画时要禁用<code>OnTouch</code>事件，因为我们做动画时并没有调用<code>mAdapter.notifyDataSetChanged()</code>，所以如果滚动，由于数据没有同步，肯定会挂掉。</li>
</ul>
<p><strong>禁用<code>OnTouch</code>事件的方法如下</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="annotation">@Override</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span>(MotionEvent ev) {</div><div class="line">    <span class="comment">// intercept touch event when deleting ,avoid listview get view.</span></div><div class="line">    <span class="keyword">if</span> (mIsDeleting) {</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.dispatchTouchEvent(ev);</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="4-ListView的工具方法">4.<code>ListView</code>的工具方法</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> View <span class="title">getChildItemView</span>(Context context, FloatingGroupExpandableListView listView, <span class="keyword">int</span> groupPosition, <span class="keyword">int</span> childPosition) {</div><div class="line">    <span class="keyword">long</span> packedPosition = ExpandableListView.getPackedPositionForChild(groupPosition, childPosition);</div><div class="line">    <span class="keyword">int</span> flatPosition;</div><div class="line">    <span class="keyword">try</span> {</div><div class="line">        flatPosition = listView.getFlatListPosition(packedPosition);</div><div class="line">    } <span class="keyword">catch</span> (Exception e) {</div><div class="line">        e.printStackTrace();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">int</span> firstPosition = listView.getFirstVisiblePosition();</div><div class="line">    <span class="keyword">int</span> wantedChild = flatPosition - firstPosition;</div><div class="line">    <span class="keyword">if</span> (wantedChild &lt; <span class="number">0</span> || wantedChild &gt;= listView.getChildCount()) {</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    }</div><div class="line">    View childItemView = listView.getChildAt(wantedChild);</div><div class="line">    childItemView.setTag(R.id.anim, AnimationUtils.loadAnimation(context, R.anim.slide_left_out));</div><div class="line">    <span class="keyword">return</span> childItemView;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> View <span class="title">getItemView</span>(Context context, ListView listView, <span class="keyword">int</span> position) {</div><div class="line">    <span class="keyword">int</span> firstPosition = listView.getFirstVisiblePosition() - listView.getHeaderViewsCount();</div><div class="line">    <span class="keyword">int</span> wantedChild = position - firstPosition;</div><div class="line">    <span class="keyword">if</span> (wantedChild &lt; <span class="number">0</span> || wantedChild &gt;= listView.getChildCount()) {</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    }</div><div class="line">    View wantedView = listView.getChildAt(wantedChild);</div><div class="line">    wantedView.setTag(R.id.anim, AnimationUtils.loadAnimation(context, R.anim.slide_left_out));</div><div class="line">    <span class="keyword">return</span> wantedView;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">clearListViewAnim</span>(Context context, ListView listView) {</div><div class="line">    <span class="keyword">int</span> first = listView.getFirstVisiblePosition();</div><div class="line">    <span class="keyword">int</span> count = listView.getChildCount() + <span class="number">2</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = first; i &lt; first + count; i++) {</div><div class="line">        View itemView = getItemView(context, listView, i);</div><div class="line">        <span class="keyword">if</span> (itemView != <span class="keyword">null</span>) {</div><div class="line">            itemView.clearAnimation();</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      
      
    </footer>
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2014 Reacoder
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">

  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>

  <script src="/js/main.js" type="text/javascript"></script>


  </div>
</body>
</html>